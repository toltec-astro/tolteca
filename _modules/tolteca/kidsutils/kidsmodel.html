
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>tolteca.kidsutils.kidsmodel &#8212; tolteca v0.0.1</title>
    <link rel="stylesheet" href="../../../_static/bootstrap-astropy.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../_static/language_data.js"></script>
    <script type="text/javascript" src="../../../_static/sidebar.js"></script>
    <script type="text/javascript" src="../../../_static/copybutton.js"></script>
    <link rel="shortcut icon" href="../../../_static/astropy_logo.ico"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'/>

  </head><body>
<div class="topbar">
  <a class="brand" title="Documentation Home" href="../../../index.html"><span id="logotext1">TolTECA</span><span id="logotext2"></span><span id="logotext3">:docs</span></a>
  <ul>
    
    <li><a class="homelink" title="Astropy Homepage" href="http://www.astropy.org"></a></li>
    <li><a title="General Index" href="../../../genindex.html">Index</a></li>
    <li><a title="Module Index" href="../../../py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="../../../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li>
	<a href="../../../index.html">tolteca v0.0.1</a>
	 &#187;
      </li>
      <li><a href="../../index.html" accesskey="U">Module code</a> &#187;</li>
      
       
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for tolteca.kidsutils.kidsmodel</h1><div class="highlight"><pre>
<span></span><span class="ch">#! /usr/bin/env python</span>

<span class="kn">from</span> <span class="nn">astropy.modeling</span> <span class="kn">import</span> <span class="n">Parameter</span><span class="p">,</span> <span class="n">Model</span>
<span class="kn">from</span> <span class="nn">astropy.modeling.core</span> <span class="kn">import</span> <span class="p">(</span>
        <span class="n">_prepare_inputs_model_set</span><span class="p">,</span> <span class="n">_prepare_inputs_single_model</span><span class="p">,</span>
        <span class="n">_validate_input_shapes</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">astropy</span> <span class="kn">import</span> <span class="n">units</span> <span class="k">as</span> <span class="n">u</span>
<span class="kn">import</span> <span class="nn">inspect</span>


<span class="k">class</span> <span class="nc">_Model</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Subclass of astropy.modeling.Model that support complex type.&quot;&quot;&quot;</span>

    <span class="c1"># code snippet from `astropy.modeling.Model`</span>
    <span class="k">def</span> <span class="nf">prepare_inputs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">inputs</span><span class="p">,</span> <span class="n">model_set_axis</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">equivalencies</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                       <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This method is used in `~astropy.modeling.Model.__call__` to ensure</span>
<span class="sd">        that all the inputs to the model can be broadcast into compatible</span>
<span class="sd">        shapes (if one or both of them are input as arrays), particularly if</span>
<span class="sd">        there are more than one parameter sets. This also makes sure that (if</span>
<span class="sd">        applicable) the units of the input will be compatible with the evaluate</span>
<span class="sd">        method.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># When we instantiate the model class, we make sure that __call__ can</span>
        <span class="c1"># take the following two keyword arguments: model_set_axis and</span>
        <span class="c1"># equivalencies.</span>

        <span class="k">if</span> <span class="n">model_set_axis</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># By default the model_set_axis for the input is assumed to be the</span>
            <span class="c1"># same as that for the parameters the model was defined with</span>
            <span class="c1"># TODO: Ensure that negative model_set_axis arguments are respected</span>
            <span class="n">model_set_axis</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model_set_axis</span>

        <span class="n">n_models</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="n">params</span> <span class="o">=</span> <span class="p">[</span><span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_names</span><span class="p">]</span>
        <span class="n">inputs</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">asanyarray</span><span class="p">(</span><span class="n">_input</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="k">for</span> <span class="n">_input</span> <span class="ow">in</span> <span class="n">inputs</span><span class="p">]</span>

        <span class="n">_validate_input_shapes</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">inputs</span><span class="p">,</span> <span class="n">n_models</span><span class="p">,</span>
                               <span class="n">model_set_axis</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">standard_broadcasting</span><span class="p">)</span>

        <span class="k">if</span> <span class="s1">&#39;inputs_map&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">inputs_map</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;inputs_map&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">inputs_map</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">inputs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_validate_input_units</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">equivalencies</span><span class="p">,</span> <span class="n">inputs_map</span><span class="p">)</span>

        <span class="c1"># The input formatting required for single models versus a multiple</span>
        <span class="c1"># model set are different enough that they&#39;ve been split into separate</span>
        <span class="c1"># subroutines</span>
        <span class="k">if</span> <span class="n">n_models</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_prepare_inputs_single_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">inputs</span><span class="p">,</span>
                                                <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_prepare_inputs_model_set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">inputs</span><span class="p">,</span> <span class="n">n_models</span><span class="p">,</span>
                                             <span class="n">model_set_axis</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_get_func_args</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getfullargspec</span><span class="p">(</span><span class="n">func</span><span class="p">)</span><span class="o">.</span><span class="n">args</span>


<span class="k">def</span> <span class="nf">_set_mutual_inversion</span><span class="p">(</span><span class="n">cls1</span><span class="p">,</span> <span class="n">cls2</span><span class="p">):</span>

    <span class="n">cls1</span><span class="o">.</span><span class="n">inverse</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="k">lambda</span> <span class="bp">self</span><span class="p">:</span> <span class="n">cls2</span><span class="p">())</span>
    <span class="n">cls2</span><span class="o">.</span><span class="n">inverse</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="k">lambda</span> <span class="bp">self</span><span class="p">:</span> <span class="n">cls1</span><span class="p">())</span>


<span class="k">class</span> <span class="nc">_ResonanceCircleTransformMixin</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Mixin class that defines basic resonance circle transform.</span>

<span class="sd">    The transform reads</span>

<span class="sd">    .. code-block:: text</span>

<span class="sd">        v&#39; = 0.5 / v</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">n_inputs</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">n_outputs</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">_separable</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">evaluate</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
        <span class="k">return</span> <span class="mf">0.5</span> <span class="o">/</span> <span class="n">value</span>


<div class="viewcode-block" id="ResonanceCircleComplex"><a class="viewcode-back" href="../../../api/tolteca.kidsutils.kidsmodel.ResonanceCircleComplex.html#tolteca.kidsutils.kidsmodel.ResonanceCircleComplex">[docs]</a><span class="k">class</span> <span class="nc">ResonanceCircleComplex</span><span class="p">(</span><span class="n">_ResonanceCircleTransformMixin</span><span class="p">,</span> <span class="n">_Model</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Model that describes the resonance circle of KIDs in complex plane.</span>

<span class="sd">    The model reads</span>

<span class="sd">    .. code-block:: text</span>

<span class="sd">        S = 0.5 / X</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inputs</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;S&#39;</span><span class="p">,</span> <span class="p">)</span></div>


<div class="viewcode-block" id="ResonanceCircleComplexInv"><a class="viewcode-back" href="../../../api/tolteca.kidsutils.kidsmodel.ResonanceCircleComplexInv.html#tolteca.kidsutils.kidsmodel.ResonanceCircleComplexInv">[docs]</a><span class="k">class</span> <span class="nc">ResonanceCircleComplexInv</span><span class="p">(</span><span class="n">_ResonanceCircleTransformMixin</span><span class="p">,</span> <span class="n">_Model</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Inversion of `ResonanceCircleComplex`.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inputs</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;S&#39;</span><span class="p">,</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="p">)</span></div>


<div class="viewcode-block" id="ResonanceCircleQr"><a class="viewcode-back" href="../../../api/tolteca.kidsutils.kidsmodel.ResonanceCircleQr.html#tolteca.kidsutils.kidsmodel.ResonanceCircleQr">[docs]</a><span class="k">class</span> <span class="nc">ResonanceCircleQr</span><span class="p">(</span><span class="n">_ResonanceCircleTransformMixin</span><span class="p">,</span> <span class="n">_Model</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Model that describes the relation of `r` and `Qr`.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inputs</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;Qr&#39;</span><span class="p">,</span> <span class="p">)</span></div>


<div class="viewcode-block" id="ResonanceCircleQrInv"><a class="viewcode-back" href="../../../api/tolteca.kidsutils.kidsmodel.ResonanceCircleQrInv.html#tolteca.kidsutils.kidsmodel.ResonanceCircleQrInv">[docs]</a><span class="k">class</span> <span class="nc">ResonanceCircleQrInv</span><span class="p">(</span><span class="n">_ResonanceCircleTransformMixin</span><span class="p">,</span> <span class="n">_Model</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Inversion of `ResonanceCircleQr`&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inputs</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;Qr&#39;</span><span class="p">,</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="p">)</span></div>


<span class="k">class</span> <span class="nc">_ResonanceCircleTransform2Mixin</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Mixin class that defines basic resonance circle transform for</span>
<span class="sd">    real and imaginary parts separately.</span>

<span class="sd">    The transform reads</span>

<span class="sd">    .. code-block:: text</span>

<span class="sd">        I + iQ = 0.5 / (r + ix)</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">n_inputs</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">n_outputs</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">_separable</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">evaluate</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">):</span>
        <span class="n">f</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">/</span> <span class="p">(</span><span class="n">v1</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">v2</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">v1</span> <span class="o">*</span> <span class="n">f</span><span class="p">,</span> <span class="o">-</span> <span class="n">v2</span> <span class="o">*</span> <span class="n">f</span>


<div class="viewcode-block" id="ResonanceCircle"><a class="viewcode-back" href="../../../api/tolteca.kidsutils.kidsmodel.ResonanceCircle.html#tolteca.kidsutils.kidsmodel.ResonanceCircle">[docs]</a><span class="k">class</span> <span class="nc">ResonanceCircle</span><span class="p">(</span><span class="n">_ResonanceCircleTransform2Mixin</span><span class="p">,</span> <span class="n">_Model</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Same as `ResonanceCircleComplex`, but with separate real and imaginary</span>
<span class="sd">    parts as inputs and outputs.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inputs</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;I&#39;</span><span class="p">,</span> <span class="s1">&#39;Q&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="ResonanceCircleInv"><a class="viewcode-back" href="../../../api/tolteca.kidsutils.kidsmodel.ResonanceCircleInv.html#tolteca.kidsutils.kidsmodel.ResonanceCircleInv">[docs]</a><span class="k">class</span> <span class="nc">ResonanceCircleInv</span><span class="p">(</span><span class="n">_ResonanceCircleTransform2Mixin</span><span class="p">,</span> <span class="n">_Model</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Inversion of `ResonanceCircle`.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inputs</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;I&#39;</span><span class="p">,</span> <span class="s1">&#39;Q&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">)</span></div>


<span class="n">_set_mutual_inversion</span><span class="p">(</span><span class="n">ResonanceCircleComplex</span><span class="p">,</span> <span class="n">ResonanceCircleComplexInv</span><span class="p">)</span>
<span class="n">_set_mutual_inversion</span><span class="p">(</span><span class="n">ResonanceCircleQr</span><span class="p">,</span> <span class="n">ResonanceCircleQrInv</span><span class="p">)</span>
<span class="n">_set_mutual_inversion</span><span class="p">(</span><span class="n">ResonanceCircle</span><span class="p">,</span> <span class="n">ResonanceCircleInv</span><span class="p">)</span>


<div class="viewcode-block" id="OpticalDetune"><a class="viewcode-back" href="../../../api/tolteca.kidsutils.kidsmodel.OpticalDetune.html#tolteca.kidsutils.kidsmodel.OpticalDetune">[docs]</a><span class="k">class</span> <span class="nc">OpticalDetune</span><span class="p">(</span><span class="n">_Model</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Model that describes detuning of KIDs in response to incident</span>
<span class="sd">    optical power.</span>

<span class="sd">    The model reads</span>

<span class="sd">    .. code-block:: text</span>

<span class="sd">        x = (p - background) * responsivity</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">n_inputs</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">n_outputs</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">_separable</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="n">background</span> <span class="o">=</span> <span class="n">Parameter</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="mf">5.0</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">pW</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mf">0.</span><span class="p">)</span>
    <span class="n">responsivity</span> <span class="o">=</span> <span class="n">Parameter</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="mf">1e-17</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="mf">1.</span> <span class="o">/</span> <span class="n">u</span><span class="o">.</span><span class="n">W</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mf">0.</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inputs</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="p">)</span>

<div class="viewcode-block" id="OpticalDetune.evaluate"><a class="viewcode-back" href="../../../api/tolteca.kidsutils.kidsmodel.OpticalDetune.html#tolteca.kidsutils.kidsmodel.OpticalDetune.evaluate">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">evaluate</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">background</span><span class="p">,</span> <span class="n">responsivity</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">p</span> <span class="o">-</span> <span class="n">background</span><span class="p">)</span> <span class="o">*</span> <span class="n">responsivity</span></div></div>


<div class="viewcode-block" id="InstrumentalDetune"><a class="viewcode-back" href="../../../api/tolteca.kidsutils.kidsmodel.InstrumentalDetune.html#tolteca.kidsutils.kidsmodel.InstrumentalDetune">[docs]</a><span class="k">class</span> <span class="nc">InstrumentalDetune</span><span class="p">(</span><span class="n">_Model</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Model that describes the detuning in terms of the probe tone and</span>
<span class="sd">    detector intrinsics.</span>

<span class="sd">    The model reads</span>

<span class="sd">    .. code-block:: text</span>

<span class="sd">        x = (fp / fr - 1.)</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">n_inputs</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">n_outputs</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">_separable</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inputs</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;fp&#39;</span><span class="p">,</span> <span class="s1">&#39;fr&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="p">)</span>

<div class="viewcode-block" id="InstrumentalDetune.evaluate"><a class="viewcode-back" href="../../../api/tolteca.kidsutils.kidsmodel.InstrumentalDetune.html#tolteca.kidsutils.kidsmodel.InstrumentalDetune.evaluate">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">evaluate</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">fr</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">fp</span> <span class="o">/</span> <span class="n">fr</span> <span class="o">-</span> <span class="mf">1.</span></div></div>


<span class="k">class</span> <span class="nc">_ComposableModelBase</span><span class="p">(</span><span class="n">_Model</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Base class that setup itself with mixin classes.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_inputs</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_outputs</span><span class="p">()</span>


<span class="k">class</span> <span class="nc">_ReadoutReprComplexMixin</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Mixin class that sets the output to use complex S21.&quot;&quot;&quot;</span>

    <span class="n">n_outputs</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">_separable</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">_set_outputs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;S&#39;</span><span class="p">,</span> <span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_repr_apply</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">a</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">1</span><span class="p">,):</span>
            <span class="n">a</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">b</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">1</span><span class="p">,):</span>
            <span class="n">b</span> <span class="o">=</span> <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="mf">1.</span><span class="n">j</span> <span class="o">*</span> <span class="n">b</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="c1"># make sure they are the same shape</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asanyarray</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asanyarray</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">():</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">asscalar</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">():</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">asscalar</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__call__</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">_ReadoutRepr2Mixin</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Mixin class that sets the output to use separate I and Q.&quot;&quot;&quot;</span>

    <span class="n">n_outputs</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">_separable</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">_set_outputs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;I&#39;</span><span class="p">,</span> <span class="s1">&#39;Q&#39;</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_repr_apply</span><span class="p">(</span><span class="n">c</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">c</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">imag</span>


<div class="viewcode-block" id="ReadoutIQToComplex"><a class="viewcode-back" href="../../../api/tolteca.kidsutils.kidsmodel.ReadoutIQToComplex.html#tolteca.kidsutils.kidsmodel.ReadoutIQToComplex">[docs]</a><span class="k">class</span> <span class="nc">ReadoutIQToComplex</span><span class="p">(</span><span class="n">_ReadoutReprComplexMixin</span><span class="p">,</span> <span class="n">_ComposableModelBase</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Utility model to convert from (I, Q) to complex S21.&quot;&quot;&quot;</span>
    <span class="n">n_inputs</span> <span class="o">=</span> <span class="mi">2</span>

    <span class="k">def</span> <span class="nf">_set_inputs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inputs</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;I&#39;</span><span class="p">,</span> <span class="s1">&#39;Q&#39;</span><span class="p">)</span>

<div class="viewcode-block" id="ReadoutIQToComplex.evaluate"><a class="viewcode-back" href="../../../api/tolteca.kidsutils.kidsmodel.ReadoutIQToComplex.html#tolteca.kidsutils.kidsmodel.ReadoutIQToComplex.evaluate">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">evaluate</span><span class="p">(</span><span class="n">I</span><span class="p">,</span> <span class="n">Q</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span>
                <span class="n">ReadoutIQToComplex</span><span class="p">,</span> <span class="n">ReadoutIQToComplex</span><span class="p">)</span><span class="o">.</span><span class="n">_repr_apply</span><span class="p">(</span><span class="n">I</span><span class="p">,</span> <span class="n">Q</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="ReadoutComplexToIQ"><a class="viewcode-back" href="../../../api/tolteca.kidsutils.kidsmodel.ReadoutComplexToIQ.html#tolteca.kidsutils.kidsmodel.ReadoutComplexToIQ">[docs]</a><span class="k">class</span> <span class="nc">ReadoutComplexToIQ</span><span class="p">(</span><span class="n">_ReadoutRepr2Mixin</span><span class="p">,</span> <span class="n">_ComposableModelBase</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Utility model to convert from complex S21 to (I, Q).&quot;&quot;&quot;</span>
    <span class="n">n_inputs</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="k">def</span> <span class="nf">_set_inputs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inputs</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;S&#39;</span><span class="p">,</span> <span class="p">)</span>

<div class="viewcode-block" id="ReadoutComplexToIQ.evaluate"><a class="viewcode-back" href="../../../api/tolteca.kidsutils.kidsmodel.ReadoutComplexToIQ.html#tolteca.kidsutils.kidsmodel.ReadoutComplexToIQ.evaluate">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">evaluate</span><span class="p">(</span><span class="n">S</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span>
                <span class="n">_ReadoutRepr2Mixin</span><span class="p">,</span> <span class="n">ReadoutComplexToIQ</span><span class="p">)</span><span class="o">.</span><span class="n">_repr_apply</span><span class="p">(</span><span class="n">S</span><span class="p">)</span></div></div>


<span class="k">class</span> <span class="nc">_ResonanceCircleSweepMixin</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Mixin class that sets up the frequency sweep model.&quot;&quot;&quot;</span>

    <span class="n">n_inputs</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="c1"># fr = Parameter(default=1e9, unit=u.Hz, min=0.)</span>
    <span class="c1"># Qr = Parameter(default=2e4)</span>

    <span class="k">def</span> <span class="nf">_set_inputs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inputs</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;f&#39;</span><span class="p">,</span> <span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">evaluate</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">fr</span><span class="p">,</span> <span class="n">Qr</span><span class="p">):</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">ResonanceCircleQrInv</span><span class="p">(</span><span class="n">Qr</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">InstrumentalDetune</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">fr</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ResonanceCircle</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>


<div class="viewcode-block" id="ResonanceCircleSweep"><a class="viewcode-back" href="../../../api/tolteca.kidsutils.kidsmodel.ResonanceCircleSweep.html#tolteca.kidsutils.kidsmodel.ResonanceCircleSweep">[docs]</a><span class="k">class</span> <span class="nc">ResonanceCircleSweep</span><span class="p">(</span>
        <span class="n">_ResonanceCircleSweepMixin</span><span class="p">,</span> <span class="n">_ReadoutRepr2Mixin</span><span class="p">,</span> <span class="n">_ComposableModelBase</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Model that describes the frequency sweep of The resonance circle.&quot;&quot;&quot;</span>
    <span class="c1"># already separate in I, Q.</span>
    <span class="k">pass</span></div>


<div class="viewcode-block" id="ResonanceCircleSweepComplex"><a class="viewcode-back" href="../../../api/tolteca.kidsutils.kidsmodel.ResonanceCircleSweepComplex.html#tolteca.kidsutils.kidsmodel.ResonanceCircleSweepComplex">[docs]</a><span class="k">class</span> <span class="nc">ResonanceCircleSweepComplex</span><span class="p">(</span>
        <span class="n">_ResonanceCircleSweepMixin</span><span class="p">,</span>
        <span class="n">_ReadoutReprComplexMixin</span><span class="p">,</span> <span class="n">_ComposableModelBase</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;The same as `ResonanceCircleSweep`, but the result is the complex S21.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">fr</span> <span class="o">=</span> <span class="n">Parameter</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="mf">1e9</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">Hz</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mf">0.</span><span class="p">)</span>
    <span class="n">Qr</span> <span class="o">=</span> <span class="n">Parameter</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="mf">2e4</span><span class="p">)</span>

    <span class="c1"># make it return complex</span>
<div class="viewcode-block" id="ResonanceCircleSweepComplex.evaluate"><a class="viewcode-back" href="../../../api/tolteca.kidsutils.kidsmodel.ResonanceCircleSweepComplex.html#tolteca.kidsutils.kidsmodel.ResonanceCircleSweepComplex.evaluate">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">evaluate</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">fr</span><span class="p">,</span> <span class="n">Qr</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_repr_apply</span><span class="p">(</span>
                <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">fr</span><span class="p">,</span> <span class="n">Qr</span><span class="p">)</span>
                <span class="p">)</span></div></div>


<span class="k">class</span> <span class="nc">_ResonanceCircleProbeMixin</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Mixin class that sets up the probing model.&quot;&quot;&quot;</span>

    <span class="n">n_inputs</span> <span class="o">=</span> <span class="mi">2</span>

    <span class="n">fp</span> <span class="o">=</span> <span class="n">Parameter</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="mf">1e9</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">Hz</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mf">0.</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_set_inputs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inputs</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;fr&#39;</span><span class="p">,</span> <span class="s1">&#39;Qr&#39;</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">evaluate</span><span class="p">(</span><span class="n">fr</span><span class="p">,</span> <span class="n">Qr</span><span class="p">,</span> <span class="n">fp</span><span class="p">):</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">ResonanceCircleQrInv</span><span class="p">(</span><span class="n">Qr</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">InstrumentalDetune</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">fr</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ResonanceCircle</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>


<div class="viewcode-block" id="ResonanceCircleProbe"><a class="viewcode-back" href="../../../api/tolteca.kidsutils.kidsmodel.ResonanceCircleProbe.html#tolteca.kidsutils.kidsmodel.ResonanceCircleProbe">[docs]</a><span class="k">class</span> <span class="nc">ResonanceCircleProbe</span><span class="p">(</span>
        <span class="n">_ResonanceCircleProbeMixin</span><span class="p">,</span> <span class="n">_ReadoutRepr2Mixin</span><span class="p">,</span> <span class="n">_ComposableModelBase</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Model that describes the probing of The resonance circle.&quot;&quot;&quot;</span>
    <span class="c1"># already separate in I, Q.</span>
    <span class="k">pass</span></div>


<div class="viewcode-block" id="ResonanceCircleProbeComplex"><a class="viewcode-back" href="../../../api/tolteca.kidsutils.kidsmodel.ResonanceCircleProbeComplex.html#tolteca.kidsutils.kidsmodel.ResonanceCircleProbeComplex">[docs]</a><span class="k">class</span> <span class="nc">ResonanceCircleProbeComplex</span><span class="p">(</span>
        <span class="n">_ResonanceCircleProbeMixin</span><span class="p">,</span> <span class="n">_ReadoutReprComplexMixin</span><span class="p">,</span>
        <span class="n">_ComposableModelBase</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;The same as `ResonanceCircleProbe`, but the result is the complex S21.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="ResonanceCircleProbeComplex.evaluate"><a class="viewcode-back" href="../../../api/tolteca.kidsutils.kidsmodel.ResonanceCircleProbeComplex.html#tolteca.kidsutils.kidsmodel.ResonanceCircleProbeComplex.evaluate">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">evaluate</span><span class="p">(</span><span class="n">fr</span><span class="p">,</span> <span class="n">Qr</span><span class="p">,</span> <span class="n">fp</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_repr_apply</span><span class="p">(</span>
                <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">fr</span><span class="p">,</span> <span class="n">Qr</span><span class="p">,</span> <span class="n">fp</span><span class="p">)</span>
                <span class="p">)</span></div></div>


<span class="k">class</span> <span class="nc">_ReadoutTransformComplexMixin</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Mixin class that setup the transformation of (I + jQ) due to readout.&quot;&quot;&quot;</span>

    <span class="n">n_inputs</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="k">def</span> <span class="nf">_set_inputs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inputs</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;S&#39;</span><span class="p">,</span> <span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_get_transform_params</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="n">exclude_args</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;S&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">a</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">_get_func_args</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">_transform</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">a</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">exclude_args</span><span class="p">]</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_get_inverse_transform_params</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="n">exclude_args</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;S&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">a</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">_get_func_args</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">_inverse_transform</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">a</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">exclude_args</span><span class="p">]</span>


<span class="k">class</span> <span class="nc">_ReadoutGeometryParamsMixin</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Mixin class that defines the KIDs parameters related to the</span>
<span class="sd">    readout circuit geometry.&quot;&quot;&quot;</span>

    <span class="n">tau</span> <span class="o">=</span> <span class="n">Parameter</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">s</span><span class="p">)</span>
    <span class="n">Qc</span> <span class="o">=</span> <span class="n">Parameter</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="mf">4e4</span><span class="p">)</span>  <span class="c1"># optimal coupling</span>
    <span class="n">Qi</span> <span class="o">=</span> <span class="n">Parameter</span><span class="p">(</span><span class="n">tied</span><span class="o">=</span><span class="k">lambda</span> <span class="n">m</span><span class="p">:</span> <span class="n">m</span><span class="o">.</span><span class="n">Qr</span> <span class="o">*</span> <span class="n">m</span><span class="o">.</span><span class="n">Qc</span> <span class="o">/</span> <span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">Qc</span> <span class="o">-</span> <span class="n">m</span><span class="o">.</span><span class="n">Qr</span><span class="p">))</span>
    <span class="n">phi_c</span> <span class="o">=</span> <span class="n">Parameter</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="mf">0.</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">_ReadoutGainParamsMixin</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Mixin class that defines some general gain parameters.</span>

<span class="sd">    Note that these parameters could mean different in different concrete</span>
<span class="sd">    classes.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">g0</span> <span class="o">=</span> <span class="n">Parameter</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="mf">1.</span><span class="p">)</span>
    <span class="n">g1</span> <span class="o">=</span> <span class="n">Parameter</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="mf">0.</span><span class="p">)</span>
    <span class="n">g</span> <span class="o">=</span> <span class="n">Parameter</span><span class="p">(</span><span class="n">tied</span><span class="o">=</span><span class="k">lambda</span> <span class="n">m</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">hypot</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">g0</span><span class="p">,</span> <span class="n">m</span><span class="o">.</span><span class="n">g1</span><span class="p">))</span>
    <span class="n">phi_g</span> <span class="o">=</span> <span class="n">Parameter</span><span class="p">(</span><span class="n">tied</span><span class="o">=</span><span class="k">lambda</span> <span class="n">m</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">g1</span><span class="p">,</span> <span class="n">m</span><span class="o">.</span><span class="n">g0</span><span class="p">))</span>


<span class="k">class</span> <span class="nc">_ReadoutLinTrendParamsMixin</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Mixin class that defines parameters that describes a</span>
<span class="sd">    linear baseline trend.&quot;&quot;&quot;</span>

    <span class="n">f0</span> <span class="o">=</span> <span class="n">Parameter</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="mf">1e9</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">Hz</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mf">0.</span><span class="p">)</span>
    <span class="n">k0</span> <span class="o">=</span> <span class="n">Parameter</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="mf">0.</span><span class="p">)</span>
    <span class="n">k1</span> <span class="o">=</span> <span class="n">Parameter</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="mf">0.</span><span class="p">)</span>
    <span class="n">m0</span> <span class="o">=</span> <span class="n">Parameter</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="mf">0.</span><span class="p">)</span>
    <span class="n">m1</span> <span class="o">=</span> <span class="n">Parameter</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="mf">0.</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">_ReadoutGainWithLinTrendMixin</span><span class="p">(</span>
        <span class="n">_ReadoutGainParamsMixin</span><span class="p">,</span> <span class="n">_ReadoutLinTrendParamsMixin</span><span class="p">,</span>
        <span class="n">_ReadoutTransformComplexMixin</span><span class="p">,</span>
        <span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Mixin class that defines readout transform of S21 using an effective</span>
<span class="sd">    complex gain and a linear baseline trend.&quot;&quot;&quot;</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_transform</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">g0</span><span class="p">,</span> <span class="n">g1</span><span class="p">,</span> <span class="n">f0</span><span class="p">,</span> <span class="n">k0</span><span class="p">,</span> <span class="n">k1</span><span class="p">,</span> <span class="n">m0</span><span class="p">,</span> <span class="n">m1</span><span class="p">):</span>
        <span class="n">gg</span> <span class="o">=</span> <span class="n">g0</span> <span class="o">+</span> <span class="mf">1.</span><span class="n">j</span> <span class="o">*</span> <span class="n">g1</span>
        <span class="n">kk</span> <span class="o">=</span> <span class="n">k0</span> <span class="o">+</span> <span class="mf">1.</span><span class="n">j</span> <span class="o">*</span> <span class="n">k1</span>
        <span class="n">mm</span> <span class="o">=</span> <span class="n">m0</span> <span class="o">+</span> <span class="mf">1.</span><span class="n">j</span> <span class="o">*</span> <span class="n">m1</span>
        <span class="k">return</span> <span class="n">gg</span> <span class="o">*</span> <span class="n">S</span> <span class="o">+</span> <span class="n">kk</span> <span class="o">*</span> <span class="p">(</span><span class="n">f</span> <span class="o">-</span> <span class="n">f0</span><span class="p">)</span> <span class="o">+</span> <span class="n">mm</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_inverse_transform</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">g0</span><span class="p">,</span> <span class="n">g1</span><span class="p">,</span> <span class="n">f0</span><span class="p">,</span> <span class="n">k0</span><span class="p">,</span> <span class="n">k1</span><span class="p">,</span> <span class="n">m0</span><span class="p">,</span> <span class="n">m1</span><span class="p">):</span>
        <span class="n">gg</span> <span class="o">=</span> <span class="n">g0</span> <span class="o">+</span> <span class="mf">1.</span><span class="n">j</span> <span class="o">*</span> <span class="n">g1</span>
        <span class="n">kk</span> <span class="o">=</span> <span class="n">k0</span> <span class="o">+</span> <span class="mf">1.</span><span class="n">j</span> <span class="o">*</span> <span class="n">k1</span>
        <span class="n">mm</span> <span class="o">=</span> <span class="n">m0</span> <span class="o">+</span> <span class="mf">1.</span><span class="n">j</span> <span class="o">*</span> <span class="n">m1</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">S</span> <span class="o">-</span> <span class="n">mm</span> <span class="o">-</span> <span class="n">kk</span> <span class="o">*</span> <span class="p">(</span><span class="n">f</span> <span class="o">-</span> <span class="n">f0</span><span class="p">))</span> <span class="o">/</span> <span class="n">gg</span>


<span class="k">class</span> <span class="nc">_ReadoutGainWithGeometryMixin</span><span class="p">(</span>
        <span class="n">_ReadoutGainParamsMixin</span><span class="p">,</span> <span class="n">_ReadoutGeometryParamsMixin</span><span class="p">,</span>
        <span class="n">_ReadoutTransformComplexMixin</span><span class="p">,</span>
        <span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Mixin class that defines readout transform of S21 using the</span>
<span class="sd">    geometry parameters.&quot;&quot;&quot;</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_transform</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">g0</span><span class="p">,</span> <span class="n">g1</span><span class="p">,</span> <span class="n">tau</span><span class="p">,</span> <span class="n">Qc</span><span class="p">,</span> <span class="n">phi_c</span><span class="p">):</span>
        <span class="n">gg</span> <span class="o">=</span> <span class="n">g0</span> <span class="o">+</span> <span class="mf">1.</span><span class="n">j</span> <span class="o">*</span> <span class="n">g1</span>
        <span class="n">cc</span> <span class="o">=</span> <span class="mf">1.</span> <span class="o">/</span> <span class="p">(</span><span class="n">Qc</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">1.</span><span class="n">j</span> <span class="o">*</span> <span class="n">phi_c</span><span class="p">))</span>
        <span class="n">aa</span> <span class="o">=</span> <span class="n">gg</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">2.</span><span class="n">j</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">f</span> <span class="o">*</span> <span class="n">tau</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">aa</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">S</span> <span class="o">*</span> <span class="n">cc</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_inverse_transform</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">g0</span><span class="p">,</span> <span class="n">g1</span><span class="p">,</span> <span class="n">tau</span><span class="p">,</span> <span class="n">Qc</span><span class="p">,</span> <span class="n">phi_c</span><span class="p">):</span>
        <span class="n">gg</span> <span class="o">=</span> <span class="n">g0</span> <span class="o">+</span> <span class="mf">1.</span><span class="n">j</span> <span class="o">*</span> <span class="n">g1</span>
        <span class="n">cc</span> <span class="o">=</span> <span class="mf">1.</span> <span class="o">/</span> <span class="p">(</span><span class="n">Qc</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">1.</span><span class="n">j</span> <span class="o">*</span> <span class="n">phi_c</span><span class="p">))</span>
        <span class="n">aa</span> <span class="o">=</span> <span class="n">gg</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">2.</span><span class="n">j</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">f</span> <span class="o">*</span> <span class="n">tau</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">S</span> <span class="o">/</span> <span class="n">aa</span><span class="p">)</span> <span class="o">/</span> <span class="n">cc</span>


<span class="k">class</span> <span class="nc">_KidsReadoutMixin</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Mixin class that defines some utility functions for readout models.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">derotate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">f</span><span class="p">):</span>
        <span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_inverse_transform_params</span><span class="p">())</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_inverse_transform</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_apply_transform</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">locals_</span><span class="p">,</span> <span class="bp">cls</span><span class="p">):</span>
        <span class="n">args</span> <span class="o">+=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">locals_</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_get_transform_params</span><span class="p">())</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_transform</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>


<div class="viewcode-block" id="KidsSweepGainWithLinTrend"><a class="viewcode-back" href="../../../api/tolteca.kidsutils.kidsmodel.KidsSweepGainWithLinTrend.html#tolteca.kidsutils.kidsmodel.KidsSweepGainWithLinTrend">[docs]</a><span class="k">class</span> <span class="nc">KidsSweepGainWithLinTrend</span><span class="p">(</span>
        <span class="n">_KidsReadoutMixin</span><span class="p">,</span> <span class="n">_ReadoutGainWithLinTrendMixin</span><span class="p">,</span>
        <span class="n">ResonanceCircleSweepComplex</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Model that describes the S21 for frequency sweep with</span>
<span class="sd">    an effective gain and a linear baseline trend.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="KidsSweepGainWithLinTrend.evaluate"><a class="viewcode-back" href="../../../api/tolteca.kidsutils.kidsmodel.KidsSweepGainWithLinTrend.html#tolteca.kidsutils.kidsmodel.KidsSweepGainWithLinTrend.evaluate">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">evaluate</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">fr</span><span class="p">,</span> <span class="n">Qr</span><span class="p">,</span> <span class="n">g0</span><span class="p">,</span> <span class="n">g1</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">phi_g</span><span class="p">,</span> <span class="n">f0</span><span class="p">,</span> <span class="n">k0</span><span class="p">,</span> <span class="n">k1</span><span class="p">,</span> <span class="n">m0</span><span class="p">,</span> <span class="n">m1</span><span class="p">):</span>
        <span class="n">S</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">fr</span><span class="p">,</span> <span class="n">Qr</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_apply_transform</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="nb">locals</span><span class="p">(),</span> <span class="nb">super</span><span class="p">())</span></div></div>


<div class="viewcode-block" id="KidsSweepGainWithGeometry"><a class="viewcode-back" href="../../../api/tolteca.kidsutils.kidsmodel.KidsSweepGainWithGeometry.html#tolteca.kidsutils.kidsmodel.KidsSweepGainWithGeometry">[docs]</a><span class="k">class</span> <span class="nc">KidsSweepGainWithGeometry</span><span class="p">(</span>
        <span class="n">_KidsReadoutMixin</span><span class="p">,</span> <span class="n">_ReadoutGainWithGeometryMixin</span><span class="p">,</span>
        <span class="n">ResonanceCircleSweepComplex</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Model that describes the S21 for frequency sweep with the geometry</span>
<span class="sd">    parameters.&quot;&quot;&quot;</span>

<div class="viewcode-block" id="KidsSweepGainWithGeometry.evaluate"><a class="viewcode-back" href="../../../api/tolteca.kidsutils.kidsmodel.KidsSweepGainWithGeometry.html#tolteca.kidsutils.kidsmodel.KidsSweepGainWithGeometry.evaluate">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">evaluate</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">fr</span><span class="p">,</span> <span class="n">Qr</span><span class="p">,</span> <span class="n">g0</span><span class="p">,</span> <span class="n">g1</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">phi_g</span><span class="p">,</span> <span class="n">tau</span><span class="p">,</span> <span class="n">Qc</span><span class="p">,</span> <span class="n">Qi</span><span class="p">,</span> <span class="n">phi_c</span><span class="p">):</span>
        <span class="n">S</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">fr</span><span class="p">,</span> <span class="n">Qr</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_apply_transform</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="nb">locals</span><span class="p">(),</span> <span class="nb">super</span><span class="p">())</span></div></div>


<div class="viewcode-block" id="KidsProbeGainWithLinTrend"><a class="viewcode-back" href="../../../api/tolteca.kidsutils.kidsmodel.KidsProbeGainWithLinTrend.html#tolteca.kidsutils.kidsmodel.KidsProbeGainWithLinTrend">[docs]</a><span class="k">class</span> <span class="nc">KidsProbeGainWithLinTrend</span><span class="p">(</span>
        <span class="n">_KidsReadoutMixin</span><span class="p">,</span> <span class="n">_ReadoutGainWithLinTrendMixin</span><span class="p">,</span>
        <span class="n">ResonanceCircleProbeComplex</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Model that describes the S21 probed at fixed frequencies with</span>
<span class="sd">    an effective gain and a linear baseline trend.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="KidsProbeGainWithLinTrend.evaluate"><a class="viewcode-back" href="../../../api/tolteca.kidsutils.kidsmodel.KidsProbeGainWithLinTrend.html#tolteca.kidsutils.kidsmodel.KidsProbeGainWithLinTrend.evaluate">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">evaluate</span><span class="p">(</span><span class="n">fr</span><span class="p">,</span> <span class="n">Qr</span><span class="p">,</span> <span class="n">fp</span><span class="p">,</span> <span class="n">g0</span><span class="p">,</span> <span class="n">g1</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">phi_g</span><span class="p">,</span> <span class="n">f0</span><span class="p">,</span> <span class="n">k0</span><span class="p">,</span> <span class="n">k1</span><span class="p">,</span> <span class="n">m0</span><span class="p">,</span> <span class="n">m1</span><span class="p">):</span>
        <span class="n">S</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">fr</span><span class="p">,</span> <span class="n">Qr</span><span class="p">,</span> <span class="n">fp</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_apply_transform</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">fp</span><span class="p">,</span> <span class="nb">locals</span><span class="p">(),</span> <span class="nb">super</span><span class="p">())</span></div></div>


<div class="viewcode-block" id="KidsProbeGainWithGeometry"><a class="viewcode-back" href="../../../api/tolteca.kidsutils.kidsmodel.KidsProbeGainWithGeometry.html#tolteca.kidsutils.kidsmodel.KidsProbeGainWithGeometry">[docs]</a><span class="k">class</span> <span class="nc">KidsProbeGainWithGeometry</span><span class="p">(</span>
        <span class="n">_KidsReadoutMixin</span><span class="p">,</span> <span class="n">_ReadoutGainWithGeometryMixin</span><span class="p">,</span>
        <span class="n">ResonanceCircleProbeComplex</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Model that describes the S21 probed at fixed frequencies with</span>
<span class="sd">    the geometry parameters.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="KidsProbeGainWithGeometry.evaluate"><a class="viewcode-back" href="../../../api/tolteca.kidsutils.kidsmodel.KidsProbeGainWithGeometry.html#tolteca.kidsutils.kidsmodel.KidsProbeGainWithGeometry.evaluate">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">evaluate</span><span class="p">(</span><span class="n">fr</span><span class="p">,</span> <span class="n">Qr</span><span class="p">,</span> <span class="n">fp</span><span class="p">,</span> <span class="n">g0</span><span class="p">,</span> <span class="n">g1</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">phi_g</span><span class="p">,</span> <span class="n">tau</span><span class="p">,</span> <span class="n">Qc</span><span class="p">,</span> <span class="n">Qi</span><span class="p">,</span> <span class="n">phi_c</span><span class="p">):</span>
        <span class="n">S</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">fr</span><span class="p">,</span> <span class="n">Qr</span><span class="p">,</span> <span class="n">fp</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_apply_transform</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">fp</span><span class="p">,</span> <span class="nb">locals</span><span class="p">(),</span> <span class="nb">super</span><span class="p">())</span></div></div>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right"> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2020, Zhiyuan Ma.<br/>
    Created using <a href="http://www.sphinx-doc.org/en/stable/">Sphinx</a> 2.3.1. &nbsp;
    Last built 28 Jan 2020. <br/>
  </p>
</footer>
  </body>
</html>